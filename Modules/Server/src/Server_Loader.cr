#
# ................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
# : 
# : 
# : 
# : _____/\\\\\\\\\\\___________________________________________________________________________/\\\\\\\\\\\_________________________________________________________________________________________________________/\\\\\\\\\\\\_________________________________________________/\\\\\\_______________________________________________________________________________________________        
# : ___/\\\/////////\\\_______________________________________________________________________/\\\/////////\\\______________________________________________________________________________________________________\/\\\////////\\\______________________________________________\////\\\_______________________________________________________________________________________________       
# : __\//\\\______\///_______________________________________________________________________\//\\\______\///____________________________________________________________/\\\_____/\\\_________/\\\__/\\\___________\/\\\______\//\\\________________________________________________\/\\\____________________/\\\\\\\\\_______________________________________________________/\\\______      
# :   ___\////\\\_____________/\\\\\\\\__/\\\\\\\\\_____/\\/\\\\\\\______/\\\\\\\\______________\////\\\_____________/\\\\\\\\______/\\\\\\\\__/\\\____/\\\__/\\/\\\\\\\__\///___/\\\\\\\\\\\___\//\\\/\\\____________\/\\\_______\/\\\_____/\\\\\\\\___/\\\____/\\\_____/\\\\\\\\_____\/\\\________/\\\\\_____/\\\/////\\\____/\\\\\__/\\\\\_______/\\\\\\\\___/\\/\\\\\\____/\\\\\\\\\\\_     
# :    ______\////\\\________/\\\//////__\////////\\\___\/\\\/////\\\___/\\\/////\\\________________\////\\\________/\\\/////\\\___/\\\//////__\/\\\___\/\\\_\/\\\/////\\\__/\\\_\////\\\////_____\//\\\\\_____________\/\\\_______\/\\\___/\\\/////\\\_\//\\\__/\\\____/\\\/////\\\____\/\\\______/\\\///\\\__\/\\\\\\\\\\___/\\\///\\\\\///\\\___/\\\/////\\\_\/\\\////\\\__\////\\\////__    
# :     _________\////\\\____/\\\___________/\\\\\\\\\\__\/\\\___\///___/\\\\\\\\\\\____________________\////\\\____/\\\\\\\\\\\___/\\\_________\/\\\___\/\\\_\/\\\___\///__\/\\\____\/\\\__________\//\\\______________\/\\\_______\/\\\__/\\\\\\\\\\\___\//\\\/\\\____/\\\\\\\\\\\_____\/\\\_____/\\\__\//\\\_\/\\\//////___\/\\\_\//\\\__\/\\\__/\\\\\\\\\\\__\/\\\__\//\\\____\/\\\______   
# :      __/\\\______\//\\\__\//\\\_________/\\\/////\\\__\/\\\_________\//\\///////______________/\\\______\//\\\__\//\\///////___\//\\\________\/\\\___\/\\\_\/\\\_________\/\\\____\/\\\_/\\___/\\_/\\\_______________\/\\\_______/\\\__\//\\///////_____\//\\\\\____\//\\///////______\/\\\____\//\\\__/\\\__\/\\\_________\/\\\__\/\\\__\/\\\_\//\\///////___\/\\\___\/\\\____\/\\\_/\\__  
# :      _\///\\\\\\\\\\\/____\///\\\\\\\\_\//\\\\\\\\/\\_\/\\\__________\//\\\\\\\\\\___________\///\\\\\\\\\\\/____\//\\\\\\\\\\__\///\\\\\\\\_\//\\\\\\\\\__\/\\\_________\/\\\____\//\\\\\___\//\\\\/________________\/\\\\\\\\\\\\/____\//\\\\\\\\\\____\//\\\______\//\\\\\\\\\\__/\\\\\\\\\__\///\\\\\/___\/\\\_________\/\\\__\/\\\__\/\\\__\//\\\\\\\\\\_\/\\\___\/\\\____\//\\\\\___ 
# :       ___\///////////________\////////___\////////\//__\///____________\//////////______________\///////////_______\//////////_____\////////___\/////////___\///__________\///______\/////_____\////__________________\////////////_______\//////////______\///________\//////////__\/////////_____\/////_____\///__________\///___\///___\///____\//////////__\///____\///______\/////____
# :
# : This code belongs to the scare security organization. This code you may use and may re distribute as this is a open source project as a base for modern day applications which need simple local HTTP routing
# :
# : Please make sure before distributing code is not directly pasted and this code is taken into affect, modified, remade, re named, re created, re modified and other forms of manipulation are required
# : 
# : If you do not modify make sure to give credits to the contributors and the security organization that developed this code
# : 
# :                 https://github.com/Scare-Security/Safe-And-Secure-Router
# : 
# :...............................................................................................................................................................................................................................................................................................................................................................................................................................................................................
module ShellCMD 
    class Loader 
            def exec(command)
                date_post = Time.local
                passedtests = 0
                blacklist = [
                    "&&", "||", "|", "(", ")", "*", "&",
                    ";", "@", "@@", "##", "#", "!", "~",
                    "`", "'", "``", "''", "{}", "[]", "[",
                    "]", "{", "}", "-", "+", ">", "<", "??????A"] of String
                puts <<-EOF 
                                    |___|________|_
                                    |___|________|_|-----
                                    |   |        |        .
                EOF
                puts "__________________________________________________________________________"
                blacklist.each_with_index do |item, idx|
                    puts "\e[38;5;49m[\e[38;5;55mDEBUG\e[38;5;49m]\e[38;5;49m[\e[38;5;55m#{date_post}\e[38;5;49m][\e[38;5;39mSecurity\e[38;5;49m] \e[38;5;55m| \e[38;5;20mChecking char \e[38;5;39m(\e[38;5;55m#{item}\e[38;5;39m) \e[38;5;20m-> \e[38;5;39m{\e[38;5;55m#{idx}/28\e[38;5;39m}"
                    if command.includes?("#{item}")
                        #https://emojicombos.com/shiba-inu-ascii-art credits to the art
                        print <<-EOF
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⡀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡰⠛⠳⢿⡀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣖⠤⣀⠀⠀⠀⠀⠀⠀⣀⣀⣼⡇⢼⣾⡮⢇⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⢸⡏⣞⣷⡨⣗⣤⣶⢶⣻⡿⣽⡿⣿⣧⣽⣿⢇⠼⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠸⡏⢻⣿⡆⣽⣿⣟⡯⣟⣿⡷⣯⡝⣟⣯⠻⣯⣿⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠘⣷⣾⡟⣿⣿⢻⡞⢻⡟⣿⣿⠁⠚⢻⣮⠙⡎⠛⡄⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣿⡿⠳⡙⡾⠿⡌⠹⡽⣏⡇⢸⣯⣼⠧⢀⡤⠜⡄⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡿⢀⢉⢉⠶⢶⣾⣦⣫⠴⣞⣾⡟⠁⡠⠈⠉⠉⠱⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⢡⠊⠉⠁⠉⠦⠍⣽⣏⣟⡳⢾⡹⡌⠀⠀⠀⠀⡱⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⡌⠀⠀⠀⠀⠀⠀⡗⡚⣺⣿⣾⣍⠻⠀⠄⠀⢠⡇⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣞⢄⡀⠀⠀⠀⢀⡉⠀⢻⣿⣿⣟⠀⠀⠀⡦⠋⡄⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡟⢎⠳⠤⣀⠀⠀⠑⠠⠜⠛⠟⠋⠀⠀⠈⠢⠀⣧⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠰⠧⣊⠿⡤⣀⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢁⣿⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡇⠂⠹⠛⠀⡁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠍⠂⠀⠀⠀Did you try to exploit this binary file? Please do not do that! see error log below for more information
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⢳⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡄⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⣰⢫⠘⣄⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡗⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⢰⢺⣻⢠⠞⠚⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣹⡀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⡇⢀⣿⡀⠀⠀⠀⠀⠀⠀⠀⢀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⡇⠀
                        ⠀⠀⠀⠀⠀⠀⢰⢽⢸⡟⡧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡇⠀
                        ⠀⠀⠀⠀⠀⠀⣞⣾⢙⣙⣳⡠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡇⠀
                        ⠀⠀⠀⠀⠀⠀⡿⣜⡄⢶⡹⣻⢆⠀⠀⠀⠀⠀⠀⠉⠀⡀⠀⠀⠀⠀⠀⠀⣰⣫⠃⠀
                        ⠀⠀⠀⠀⠀⠀⡧⡇⡎⣞⢷⡹⣯⣆⠀⠀⠀⠀⠀⠀⠐⠁⠀⢨⠀⠀⠀⢀⢳⡇⠀⠀
                        ⠀⠀⠀⠀⠀⢠⣗⢣⠟⡸⢛⢷⠧⠁⡆⠀⣰⠀⠀⠀⠀⠀⠀⢸⠀⠀⠀⠧⠍⡇⠀⠀
                        ⠀⠀⠀⠀⠀⣼⣾⣿⣾⡥⠸⠊⠔⠀⠇⢸⠁⠂⠀⠀⠀⢀⠀⣸⠀⡆⠀⠈⢣⡇⠀⠀
                        ⠀⠀⠀⠀⢰⣟⡿⢿⡿⣿⡀⠀⠀⠀⠆⣸⡀⠠⡆⠀⡘⠈⠠⡇⠀⠀⠀⠀⢸⠁⠀⠀
                        ⠀⠀⠀⢠⡞⣴⣾⣷⡳⠉⢁⠀⢠⠔⠀⣿⠇⢇⠃⡜⡇⢀⣼⣿⠀⠀⠀⠀⡞⠀⠀⠀
                        ⠀⠀⠀⣮⢷⡹⣿⣿⠅⠀⢘⡄⡲⡀⠀⣧⣾⣎⣾⣴⣴⣶⡿⠃⡆⠀⠀⠀⡇⠀⠀⠀
                        ⠀⠀⠘⣯⢷⡹⣞⡱⠈⠠⠈⣇⠀⠱⠈⡻⡚⡏⣙⣿⡿⠁⠀⠀⢸⠀⡐⠀⡇⠀⠀⠀
                        ⠀⠀⡴⣯⢧⣳⡍⢤⠃⠀⠀⢯⢀⠇⢠⣹⢶⣿⣿⡟⠃⠀⠀⠀⠀⣷⠣⠀⢗⠀⠀⠀
                        ⠀⣼⣿⣼⣿⣧⡛⡼⠀⡠⠃⣸⢼⠛⡀⣟⣸⣿⣿⠇⠠⠘⠀⠀⠀⡟⡀⡇⢸⠀⠀⠀
                        ⢸⣾⡿⠿⡿⠷⠟⠁⢁⢀⢠⡇⢌⡢⢅⡷⣿⣟⠃⠀⠀⠀⠀⠀⣠⣗⠸⢛⢸⡄⠀⠀
                        ⠈⣼⣿⣋⣷⣶⡾⣿⣧⡈⡇⠷⢎⡜⡣⢹⡹⡒⣂⣔⠥⣀⡀⢀⢿⣇⣆⠈⠀⣿⣦⠀
                        ⠀⠻⠿⣿⣿⢻⢉⡇⢹⡿⠤⢸⣇⣕⣡⣽⠓⠛⠋⠉⠉⠀⠀⠀⠀⠈⢯⡶⡿⠿⡥⡀
                        ⠀⠀⠀⠀⠉⠉⠛⠷⠾⠃⠀⢨⣼⠁⣇⣹⡗⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⠿⣿⣄⣽⡼
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢛⠒⠛⠒⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        EOF
                        puts "\e[38;5;49m[\e[38;5;55mDEBUG\e[38;5;49m]\e[38;5;49m[\e[38;5;55m#{date_post}\e[38;5;49m][\e[38;5;39mSecurity\e[38;5;196m] INTRUSION PREVENTION SYSTEM TRIPPED!!!!!!!!!! WARNING: ERROR: FATAL: LOG: YOU ARE NOT ALLOWED TO CONTINUE USING THE FRIZZ FRAMEWORK, the intrusion prevention system was tripped possibly by your argument being a blacklisted character which was seen here #{item} in security check #{idx} out of 28 tests, please make sure your filepath is not an attempt to inject, exploit, or crash the binary file. PRO USERS WILL BE BANNED AND FORCED TO RE VALIDATE THEIR KEYS!!!! ( BETA NOTICE ) If you are trying to exploit this code i wish you the best of luck to doing so, if you think it is possible then go for it. If you are a developer testing this tool for vulnerabilities please make sure you report the vulnerability to the git repo, give a detailed report, show what you used to bypass, and show exactly how you did it with backed up proof such as a POC to see why this is dangerous. "
                        exit(1) # exit and call security issue
                    else
                        passedtests += 1
                    end
                end
                if passedtests == 29
                    puts "\e[38;5;49m[\e[38;5;55mDEBUG\e[38;5;49m]\e[38;5;49m[\e[38;5;55m#{date_post}\e[38;5;49m][\e[38;5;39mSecurity\e[38;5;49m] \e[38;5;55m| \e[38;5;20mAll tests passed (⇀‸↼‶)⊃━☆ﾟ.*･｡ﾟ"
                    system(command)
                end
            end
        end
    end